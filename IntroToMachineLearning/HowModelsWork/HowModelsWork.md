### Introduction（序章）

まずは、機械学習モデルがどのように動作し、どのように使われるのかを概観します。もしあなたがすでに統計モデリングや機械学習を経験しているなら、少し基本的すぎるかもしれません。でも心配はいりません。このコースでは、すぐにもっと強力なモデルを構築していくことになります。

このコースでは、次のようなシナリオに沿ってモデルを作っていきます。

あなたのいとこは、不動産投資で何百万ドルも稼いでいます。そして、あなたがデータサイエンスに興味を持っていることを理由に、一緒にビジネスをしようと誘ってきます。
彼はいくらでも資金を出すので、あなたは「さまざまな家がいくらで売れるかを予測するモデル」を提供する役目です。

あなたはいとこに「どうやって不動産価格を予測してきたの？」と尋ねると、最初は「直感だよ」と言います。しかしさらに深掘りすると、実際は「これまで見てきた家の価格パターンを覚えていて、それを使って新しい家の価格を推測している」ことがわかります。

機械学習も同じ仕組みで動きます。
ここでは「決定木（Decision Tree）」と呼ばれるモデルから始めます。もっと高性能なモデルもたくさんありますが、決定木は理解しやすく、しかも強力なモデルの“基礎ブロック”でもあります。

簡単のため、最もシンプルな決定木から始めます。

### First Decision Trees（最初の決定木）

このモデルでは、家をたった 2 つのカテゴリ に分けます。
そして、予測される価格は「同じカテゴリに属する過去の家の平均価格」になります。

- 家をどう 2 つのグループに分けるか

- 各グループの平均価格をどう計算するか

これらはすべて データを使って決められます。
このように、データからパターンを抽出するステップを 「モデルをフィット（fit）する」「トレーニングする」 と呼びます。
また、モデルの学習に使うデータを 「訓練データ（training data）」 と言います。

どうやって最適な分割を見つけるか、といった詳しい話はやや複雑なので後で扱うことにします。

モデルを学習し終わったら、新しい家のデータに対して価格を予測できるようになります。

### 決定木を改良する

次の 2 つの決定木のうち、実際の不動産データを使って学習したとき、より現実的な結果になりそうなのはどちらでしょうか？

### 最初の決定木

左側の決定木（Decision Tree 1）の方がもっともらしく見えます。
なぜなら、寝室の数が多い家ほど価格が高くなる傾向がある、という現実を反映しているからです。

しかし、このモデルには大きな欠点があります。
浴室の数・土地の広さ・立地など、家の価格に影響する多くの要素をまったく考慮できていないことです。

### より多くの要素を取り入れるには？

もっと多くの要素を反映させるには、分岐（split）を増やす必要があります。
分岐が増えるほど「木が深くなる（deeper tree）」と呼ばれます。

たとえば、家の敷地（lot size）も考慮に入れた場合、決定木は次のような形になります。

### 予測の仕組み

家の価格を予測するときは、
その家が持つ特徴に従って、決定木の上から下へとたどっていきます。

ツリーの最下部で得られる値がその家の予測価格です。
そして、予測を行うその最下段のポイントを 葉（leaf） と呼びます。
